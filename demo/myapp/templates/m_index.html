{% extends "base.html" %}
{% import "bootstrap/wtf.html" as wtf %}
{% import "_macros.html" as macros %}




{% block title %}Flasky - Page Not Found{% endblock %}

{% block page_content %}
    <div id="main_content" style="margin:3% ">
        {# 页头#}
        <div class="row"  style="height: 130px ;background-image:url('{{ url_for('static', filename='back.png')}}'); margin-bottom: 20px">
            <div class="page-header" style="border-bottom: 0px">
                <h2 style="font-size: 25px;padding-left: 8%;padding-top: 6px;color: #8b8792">很幸运能在最美的青春遇见你!</h2>
            </div>
        </div>
        {#主体#}
        <div class="row">
            {# 左侧#}
            <div id="left" class="col-md-3 col-sm-3"></div>

            {#中间#}
            <div id="main" class="col-md-6 col-sm-6">

                <div id="send" class="row">
                    {% if current_user.can(Permission.WRITE_ARTICLES) %}

                        {#<div class="row">
                        <button class="btn btn-danger" id="btn-postSay" style="float: right; margin-right: 20px"><span class="glyphicon glyphicon-pencil"  style="margin-right: 2px"></span><span>发表</span></button>
                    </div>#}

                        {#发表表单#}
                        <div class="row" id="postSay" >
                            <form method="post" action="/">
                                <div class="row">
                                    <div class="col-md-11"  style="margin-left: 16px;padding-right:25px"  >
                                        {{ form.body(class="form-control",placeholder="文字限制在300个字数以内",style="resize:none;",autofocus="autofocus",required="required") }}
                                        <div style= "position:relative;top: -17px;float: right">
                                            <a><span class="glyphicon glyphicon-camera pop-pick" style="padding-right:2px"></span></a>
                                        </div>
                                        {{ form.cls }}
                                        {{ form.file_urls }}
                                        {{ form.csrf_token }}
                                    </div>
                                    <div class="col-md-1"></div>
                                </div>
                                <div class="row" style=" ">
                                    <div style="float: right;margin-right: 63px;margin-top: -10px">
                                        {{ form.submit(class="btn btn-info",style="padding-right: 20px;padding-left: 20px") }}
                                    </div>
                                </div>
                            </form>
                            {#发表表单#}
                        </div>

                        {#文件上传#}
                        <div class="row" >
                            <div class="col-sm-10" >
                                <div id="uploader"  class="uploader" >
                                    <div class="queueList">
                                        <div id="dndArea" class="placeholder">
                                            <div id="filePicker"></div>
                                            <p>或将照片拖到这里，单次最多可选8张</p>
                                        </div>
                                    </div>
                                    <div class="statusBar" >
                                        <div class="progress">
                                            <span class="text">0%</span>
                                            <span class="percentage"></span>
                                        </div><div class="info"></div>
                                        <div class="btns">
                                            <div id="filePicker2"></div><div class="uploadBtn">开始上传</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {#文件上传#}
                        </div>


                    {% endif %}
                </div>


                {#动态#}
                <div id="post" class="row" >
                    <div class="post-tabs" >
                        <ul class="content-tabs" style="margin-top: 20px;margin-bottom: 20px">

                        </ul>
                        <ul class="nav nav-tabs">
                            <li{% if not show_followed %} class="active"{% endif %}><a href="{{ url_for('.show_all') }}">全部</a></li>
                            {% if current_user.is_authenticated %}
                                <li{% if show_followed %} class="active"{% endif %}><a href="{{ url_for('.show_followed') }}">关注</a></li>
                            {% endif %}
                        </ul>
                        {% include '_posts.html' %}
                    </div>
                    {#动态#}
                </div>

                {#分页部分#}
                <div id="page" class="row">
                    <div class="pagination ">
                        {{ macros.pagination_widget(pagination, '.index') }}
                    </div>
                    {#分页部分#}
                </div>
                {#中间#}
            </div>

            {#右侧#}
            <div id="right" class="col-md-3 col-sm-3">右侧</div>
            {#主体#}
        </div>

    </div>
{% endblock %}

{% block scripts %}
    {{ super() }}
    {{ pagedown.include_pagedown() }}
    {#    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='pro/webuploader/webuploader.css') }}">
    <script type="text/javascript" src="{{ url_for('static', filename='pro/webuploader/webuploader.min.js') }}"></script>#}
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='pro/webuploader/webuploader.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='pro/webuploader/style.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='pro/img_viewer/viewer.css') }}">
    <script type="text/javascript" src="{{ url_for('static', filename='pro/webuploader/webuploader.js')}}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='pro/img_viewer/viewer.js')}}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='pro/webuploader/upload.js')}}"></script>
    <script type="text/javascript">
        $('.images').viewer();

        {#   $("#btn-postSay").click(function () {
               $("#btn-postSay").hide();
               $("#postSay").show();
           });#}

        $('.pop-pick').popover(
            {   html:true,
                placement:"bottom",
                content:'<a  href="javascript:void(0);" id="popimage" onclick="pop_image()"><label  style="width: 50px;height: 50px;margin-bottom:-20px" >' +
                '<span class="glyphicon glyphicon-picture"></span><span style="margin-left: 2px">照片</span></label></a>' +
                '<hr style="margin-bottom: 0px;margin-top: 0px">' +
                '<a  href="javascript:void(0);" class="popvideo" onclick="pop_video()"  ><label style="margin-top: 8px"><span class="glyphicon glyphicon-film"></span><span style="margin-left: 2px">视频<sapn></label></a>',
                trigger:'click',

            }
        );
        {#隐藏文件上传区域#}
        $("#uploader").removeAttr("class");
        $("#uploader").attr("class","webuploader-element-invisible");
        function pop_image() {
            {#设置表单的文件类型#}
            $('#cls').val('1');
            fileSum=8;//文件个数
            fileSizeOne=10 * 1024 * 1024;//单个文件大小
            flieSizeSum=80 * 1024 * 1024;//总文件大小
            file_extensions ='gif,jpg,jpeg,bmp,png';
            file_title='Images';
            file_type='image/*';
            uploader.reset();
            uploader.destroy();
            create();
            {#这段代码应该在设置参数的前面#}
            $('.pop-pick').popover('hide');
            $("#uploader").removeAttr("class");
            $("#uploader").attr("class", "webuploader-container");
            $("#filePicker > div.webuploader-pick").css('background','#00cc66');
            uploader.option( 'fileNumLimit',fileSum );
            uploader.option( 'fileSingleSizeLimit',fileSizeOne );
            uploader.option( 'fileSizeLimit',flieSizeSum );
            uploader.option( 'accept ', {
                title : file_title,
                extensions : file_extensions,
                mimeTypes :file_type
            });


        };

        function pop_video(){
            {#设置表单的文件类型#}
            $('#cls').val('2');
            fileSum=1;//文件个数
            fileSizeOne=80 * 1024 * 1024;//单个文件大小
            flieSizeSum=80 * 1024 * 1024;//总文件大小
            file_extensions ='mp4,swf,avi,mov';
            file_title='Videos';
            file_type='video/*';
            uploader.reset();
            uploader.destroy();
            create();
            {#这段代码应该在设置参数的前面#}
            $('.pop-pick').popover('hide');
            $("#uploader").removeAttr("class");
            $("#uploader").attr("class", "webuploader-container");
            $("#dndArea > p").html("或将视频拖到这里，单次最多上传一个视频");
            $("#filePicker > div.webuploader-pick").css('background','#8fc13e')
            window.uploader.option( 'fileNumLimit',fileSum );
            window.uploader.option( 'fileSingleSizeLimit',fileSizeOne );
            window.uploader.option( 'fileSizeLimit',flieSizeSum );
            window.uploader.option( 'accept ', {
                title : file_title,
                extensions : file_extensions,
                mimeTypes :file_type
            });

        };

        function heart(id,count) {

            $.post( "/heart/"+id,function (data,status) {

                    if (data=='1'){
                        {#点赞#}
                        if($('#'+id).text()==count){
                            count=count+1;
                            $('#'+id).text(count);
                        }else {
                            $('#'+id).text(count);
                        }

                    }else {
                        {#取消点赞#}
                        if($('#'+id).text()==count){
                            count=count-1;
                            $('#'+id).text(count);
                        }else {
                            $('#'+id).text(count);
                        }

                    }

                }

            );
        }
    </script>

{% endblock %}


